<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create a poll - reso_li</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <header class="header">
        <a href="/" class="logo">reso<span class="accent">_</span>l<span class="accent">i</span></a>
        <div class="header-actions">
            <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <svg class="moon-icon hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
                <span class="theme-label" id="themeLabel">light</span>
            </button>
        </div>
    </header>

    <main class="container-narrow">
        <h1 class="text-center mt-4 mb-4">Create a poll</h1>

        <!-- Step 1: Poll setup -->
        <div id="setupStep" class="card">
            <h2 class="card-title">Poll settings</h2>

            <div class="form-group">
                <label class="form-label" for="accessCode">Access code</label>
                <input type="text" id="accessCode" class="form-input" placeholder="e.g., myworkshop" maxlength="50" autocomplete="off">
                <p class="form-hint">This will be used in the URL: reso.li/for?poll=<span id="codePreview">yourcode</span></p>
                <p id="codeError" class="form-error hidden"></p>
            </div>

            <div class="form-group">
                <label class="form-label" for="password">Management password</label>
                <input type="password" id="password" class="form-input" placeholder="Password to manage this poll">
                <p class="form-hint">You'll need this to edit questions and view results</p>
            </div>

            <div class="form-group">
                <label class="form-label" for="availableFrom">Available from (optional)</label>
                <input type="datetime-local" id="availableFrom" class="form-input">
            </div>

            <div class="form-group">
                <label class="form-label" for="availableUntil">Available until (optional)</label>
                <input type="datetime-local" id="availableUntil" class="form-input">
            </div>

            <button id="createPollBtn" class="btn btn-primary w-full">Create poll</button>
        </div>

        <!-- Step 2: Poll overview + Add questions (master/detail) -->
        <div id="questionsStep" class="hidden">
            <div class="card mb-3">
                <div class="flex justify-between items-center mb-2">
                    <h2 class="card-title" style="margin-bottom: 0;">Your poll is ready!</h2>
                </div>
                <p class="text-muted mb-2">Give respondents the access code, or share this link directly:</p>
                <div class="flex gap-1">
                    <input type="text" id="pollUrl" class="form-input" readonly>
                    <button id="copyUrlBtn" class="btn btn-secondary">Copy</button>
                </div>
            </div>

            <!-- Questions list (poll overview) -->
            <div id="questionsListContainer" class="card mb-3">
                <h2 class="card-title">Questions</h2>
                <div id="questionsList" class="question-list"></div>
                <p id="noQuestionsMsg" class="text-muted">No questions added yet.</p>
            </div>

            <!-- Add question form -->
            <div class="card mb-3">
                <h2 class="card-title">Add a question</h2>

                <div class="form-group">
                    <label class="form-label" for="questionTitle">Title (optional, for your reference)</label>
                    <input type="text" id="questionTitle" class="form-input" placeholder="e.g., Question about preferences">
                </div>

                <div class="form-group">
                    <label class="form-label">Question content</label>
                    <div class="editor-toolbar" id="editorToolbar">
                        <button type="button" data-command="bold" title="Bold"><strong>B</strong></button>
                        <button type="button" data-command="italic" title="Italic"><em>I</em></button>
                        <button type="button" data-command="underline" title="Underline"><u>U</u></button>
                        <span class="separator"></span>
                        <div class="color-picker">
                            <button type="button" id="colorPickerBtn" title="Text color">A</button>
                            <div class="color-picker-dropdown" id="colorDropdown">
                                <button type="button" class="color-swatch" data-color="#1a1a1a" style="background:#1a1a1a"></button>
                                <button type="button" class="color-swatch" data-color="#dc2626" style="background:#dc2626"></button>
                                <button type="button" class="color-swatch" data-color="#ea580c" style="background:#ea580c"></button>
                                <button type="button" class="color-swatch" data-color="#ca8a04" style="background:#ca8a04"></button>
                                <button type="button" class="color-swatch" data-color="#16a34a" style="background:#16a34a"></button>
                                <button type="button" class="color-swatch" data-color="#2563eb" style="background:#2563eb"></button>
                                <button type="button" class="color-swatch" data-color="#7c3aed" style="background:#7c3aed"></button>
                                <button type="button" class="color-swatch" data-color="#db2777" style="background:#db2777"></button>
                            </div>
                        </div>
                        <span class="separator"></span>
                        <button type="button" id="monospaceBtn" title="Monospace font">{ }</button>
                    </div>
                    <div contenteditable="true" id="questionContent" class="editor-content" placeholder="Enter your question or statement here..."></div>
                </div>

                <div class="form-group">
                    <label class="form-check">
                        <input type="checkbox" id="allowMultiple">
                        <span class="form-check-label">Allow multiple selections</span>
                    </label>
                </div>

                <div class="form-group">
                    <label class="form-label">Answer options</label>
                    <div id="optionsContainer">
                        <div class="flex gap-1 mb-1 option-row">
                            <input type="text" class="form-input option-input" placeholder="Option 1">
                            <button type="button" class="btn btn-secondary btn-sm remove-option-btn" disabled>-</button>
                        </div>
                        <div class="flex gap-1 mb-1 option-row">
                            <input type="text" class="form-input option-input" placeholder="Option 2">
                            <button type="button" class="btn btn-secondary btn-sm remove-option-btn" disabled>-</button>
                        </div>
                    </div>
                    <button type="button" id="addOptionBtn" class="btn btn-secondary btn-sm mt-1">+ Add option</button>
                </div>

                <button id="addQuestionBtn" class="btn btn-primary w-full">Add question</button>
                <p id="questionError" class="form-error hidden mt-1"></p>
            </div>

            <div class="card">
                <a id="managePollLink" href="#" class="btn btn-primary w-full">Go to poll management</a>
            </div>
        </div>
    </main>

    <script src="/js/app.js"></script>
    <script src="/js/editor.js"></script>
    <script src="/js/ask.js"></script>
</body>
</html>
